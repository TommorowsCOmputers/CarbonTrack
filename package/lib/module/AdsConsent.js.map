{"version":3,"names":["TCModel","TCString","NativeModules","AdsConsentDebugGeography","AdsConsentPurposes","AdsConsentSpecialFeatures","isPropertySet","isArray","isBoolean","isObject","isString","native","RNGoogleMobileAdsConsentModule","AdsConsent","requestInfoUpdate","options","Error","debugGeography","DISABLED","EEA","NOT_EEA","tagForUnderAgeOfConsent","testDeviceIdentifiers","deviceId","showForm","reset","getTCString","getTCModel","tcString","decode","getUserChoices","tcModel","e","__DEV__","console","warn","activelyScanDeviceCharacteristicsForIdentification","specialFeatureOptins","has","ACTIVELY_SCAN_DEVICE_CHARACTERISTICS_FOR_IDENTIFICATION","applyMarketResearchToGenerateAudienceInsights","purposeConsents","APPLY_MARKET_RESEARCH_TO_GENERATE_AUDIENCE_INSIGHTS","createAPersonalisedAdsProfile","CREATE_A_PERSONALISED_ADS_PROFILE","createAPersonalisedContentProfile","developAndImproveProducts","DEVELOP_AND_IMPROVE_PRODUCTS","measureAdPerformance","MEASURE_AD_PERFORMANCE","measureContentPerformance","MEASURE_CONTENT_PERFORMANCE","selectBasicAds","SELECT_BASIC_ADS","selectPersonalisedAds","SELECT_PERSONALISED_ADS","selectPersonalisedContent","SELECT_PERSONALISED_CONTENT","storeAndAccessInformationOnDevice","STORE_AND_ACCESS_INFORMATION_ON_DEVICE","usePreciseGeolocationData","USE_PRECISE_GEOLOCATION_DATA"],"sources":["AdsConsent.ts"],"sourcesContent":["/*\n * Copyright (c) 2016-present Invertase Limited & Contributors\n *\n * Licensed under the Apache License, Version 2.0 (the \"License\");\n * you may not use this library except in compliance with the License.\n * You may obtain a copy of the License at\n *\n *   http://www.apache.org/licenses/LICENSE-2.0\n *\n * Unless required by applicable law or agreed to in writing, software\n * distributed under the License is distributed on an \"AS IS\" BASIS,\n * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n * See the License for the specific language governing permissions and\n * limitations under the License.\n *\n */\n\nimport { TCModel, TCString } from '@iabtcf/core';\nimport { NativeModules } from 'react-native';\nimport { AdsConsentDebugGeography } from './AdsConsentDebugGeography';\nimport { AdsConsentPurposes } from './AdsConsentPurposes';\nimport { AdsConsentSpecialFeatures } from './AdsConsentSpecialFeatures';\nimport { isPropertySet, isArray, isBoolean, isObject, isString } from './common';\nimport {\n  AdsConsentFormResult,\n  AdsConsentInfo,\n  AdsConsentInfoOptions,\n  AdsConsentInterface,\n  AdsConsentUserChoices,\n} from './types/AdsConsent.interface';\n\nconst native = NativeModules.RNGoogleMobileAdsConsentModule;\n\nexport const AdsConsent: AdsConsentInterface = {\n  requestInfoUpdate(options: AdsConsentInfoOptions = {}): Promise<AdsConsentInfo> {\n    if (!isObject(options)) {\n      throw new Error(\"AdsConsent.requestInfoUpdate(*) 'options' expected an object value.\");\n    }\n\n    if (\n      isPropertySet(options, 'debugGeography') &&\n      options.debugGeography !== AdsConsentDebugGeography.DISABLED &&\n      options.debugGeography !== AdsConsentDebugGeography.EEA &&\n      options.debugGeography !== AdsConsentDebugGeography.NOT_EEA\n    ) {\n      throw new Error(\n        \"AdsConsent.requestInfoUpdate(*) 'options.debugGeography' expected one of AdsConsentDebugGeography.DISABLED, AdsConsentDebugGeography.EEA or AdsConsentDebugGeography.NOT_EEA.\",\n      );\n    }\n\n    if (\n      isPropertySet(options, 'tagForUnderAgeOfConsent') &&\n      !isBoolean(options.tagForUnderAgeOfConsent)\n    ) {\n      throw new Error(\n        \"AdsConsent.requestInfoUpdate(*) 'options.tagForUnderAgeOfConsent' expected a boolean value.\",\n      );\n    }\n\n    if (isPropertySet(options, 'testDeviceIdentifiers')) {\n      if (!isArray(options.testDeviceIdentifiers)) {\n        throw new Error(\n          \"AdsConsent.requestInfoUpdate(*) 'options.testDeviceIdentifiers' expected an array of string values.\",\n        );\n      }\n\n      for (const deviceId of options.testDeviceIdentifiers ?? []) {\n        if (!isString(deviceId)) {\n          throw new Error(\n            \"AdsConsent.requestInfoUpdate(*) 'options.testDeviceIdentifiers' expected an array of string values.\",\n          );\n        }\n      }\n    }\n\n    return native.requestInfoUpdate(options);\n  },\n\n  showForm(): Promise<AdsConsentFormResult> {\n    return native.showForm();\n  },\n\n  reset(): void {\n    return native.reset();\n  },\n\n  getTCString(): Promise<string> {\n    return native.getTCString();\n  },\n\n  async getTCModel(): Promise<TCModel> {\n    const tcString = await native.getTCString();\n    return TCString.decode(tcString);\n  },\n\n  async getUserChoices(): Promise<AdsConsentUserChoices> {\n    const tcString = await native.getTCString();\n\n    let tcModel: TCModel;\n\n    try {\n      tcModel = TCString.decode(tcString);\n    } catch (e) {\n      tcModel = new TCModel();\n\n      if (__DEV__) {\n        // eslint-disable-next-line no-console\n        console.warn(`Failed to decode tcString ${tcString}:`, e);\n      }\n    }\n\n    return {\n      activelyScanDeviceCharacteristicsForIdentification: tcModel.specialFeatureOptins.has(\n        AdsConsentSpecialFeatures.ACTIVELY_SCAN_DEVICE_CHARACTERISTICS_FOR_IDENTIFICATION,\n      ),\n      applyMarketResearchToGenerateAudienceInsights: tcModel.purposeConsents.has(\n        AdsConsentPurposes.APPLY_MARKET_RESEARCH_TO_GENERATE_AUDIENCE_INSIGHTS,\n      ),\n      createAPersonalisedAdsProfile: tcModel.purposeConsents.has(\n        AdsConsentPurposes.CREATE_A_PERSONALISED_ADS_PROFILE,\n      ),\n      createAPersonalisedContentProfile: tcModel.purposeConsents.has(\n        AdsConsentPurposes.CREATE_A_PERSONALISED_ADS_PROFILE,\n      ),\n      developAndImproveProducts: tcModel.purposeConsents.has(\n        AdsConsentPurposes.DEVELOP_AND_IMPROVE_PRODUCTS,\n      ),\n      measureAdPerformance: tcModel.purposeConsents.has(AdsConsentPurposes.MEASURE_AD_PERFORMANCE),\n      measureContentPerformance: tcModel.purposeConsents.has(\n        AdsConsentPurposes.MEASURE_CONTENT_PERFORMANCE,\n      ),\n      selectBasicAds: tcModel.purposeConsents.has(AdsConsentPurposes.SELECT_BASIC_ADS),\n      selectPersonalisedAds: tcModel.purposeConsents.has(\n        AdsConsentPurposes.SELECT_PERSONALISED_ADS,\n      ),\n      selectPersonalisedContent: tcModel.purposeConsents.has(\n        AdsConsentPurposes.SELECT_PERSONALISED_CONTENT,\n      ),\n      storeAndAccessInformationOnDevice: tcModel.purposeConsents.has(\n        AdsConsentPurposes.STORE_AND_ACCESS_INFORMATION_ON_DEVICE,\n      ),\n      usePreciseGeolocationData: tcModel.specialFeatureOptins.has(\n        AdsConsentSpecialFeatures.USE_PRECISE_GEOLOCATION_DATA,\n      ),\n    };\n  },\n};\n"],"mappings":"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","ignoreList":[]}